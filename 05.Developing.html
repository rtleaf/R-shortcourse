<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>05.Developing.utf8.md</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R shortcourse</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="01.Rstudio.and.R.html">R and Rstudio</a>
</li>
<li>
  <a href="02.Getting.Started.html">Getting Started</a>
</li>
<li>
  <a href="03.Working.html">Working in R</a>
</li>
<li>
  <a href="04.Funct.html">R Functionality</a>
</li>
<li>
  <a href="05.Developing.html">Developing Code</a>
</li>
<li>
  <a href="06.Parametric.html">Parametric Statistics</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="components-of-an-r-script" class="section level3">
<h3>Components of an R script</h3>
<p>As a new programmer you may not foresee that soon you will have many hundreds and thousands of lines of code spread across multiple files. To organize and be able to revisit this code you will want to begin early in your programming</p>
<p>Header:</p>
<ol style="list-style-type: decimal">
<li>Name (the author of the code including contact info)</li>
<li>Date (helps you organize scripts)</li>
<li>Purpose (what does this accomplish)</li>
<li>Version number (you may be annotating the same code over many years)</li>
<li>Line by line annotation</li>
</ol>
<pre class="r"><code># R. Leaf   July 29, 2016
# v04
# Script for R shortcourse. The script has the following components:

# 1. Documentation of scripts
# 2. Demonstration of writing code
# 3. Discussion of basic statistical tools
# 4. Etc., etc...

# Some text narrative that describes the sources, motivations, and citations. e.g.
# Crawley, Michael J. Statistics: an introduction using R. John Wiley &amp; Sons, 2014.</code></pre>
<p>Excecutable, annotated, organized code</p>
<p>Tidy and well-organized</p>
<pre class="r"><code># Code to keep workspace clean
# Functions ls() and rm()
?ls
?rm</code></pre>
<ul>
<li>ALWAYS type parentheses, braces, and brackets in pairs.</li>
<li>Avoid naming object with the names of functions in base R or R packages.</li>
<li>Annotate excessively</li>
<li>Script in the console, execture small pieces of code then</li>
</ul>
<p>Order matters:</p>
<ul>
<li>Because R is an “interpreted language” objects must be loaded into the environment prior to using it.</li>
<li>Some languages involve compiling the code - in that case order generally does not matter.</li>
<li>Therefore, define object (data) and parameters in the very top of your script.</li>
</ul>
<p>Use meaningful variable names:</p>
<ul>
<li>Variable names (e.g. x, g., and y are not meaningful).</li>
<li>Script file names “final.r” “your.name.r” are not meaningful.</li>
<li><p>Consider adopting a variable naming structure using meaningful abbreviations</p>
<ul>
<li>“.vec”</li>
<li>“.df”</li>
<li>“.list”</li>
</ul></li>
</ul>
<p>Keep directory structure flexible:</p>
<ul>
<li>Hardcoding means that your code cannot be shared.</li>
<li>Ex. a harcoded system path to your machine will not work on someone else’s machine.</li>
<li>“<strong>load()</strong>” for example should not have a hardcoded path.</li>
<li>Use packages</li>
</ul>
<p>How not to write code:</p>
<ul>
<li>Don’t use a script editor and write large, multi-line chunks of nested functions.</li>
<li>Run this code, untested, and backtrack to discover and remedy errors.</li>
</ul>
<p>Better programming practice: A biologists humble advice about how to code in any programming language</p>
<ul>
<li>Trade elegance for simplicity.</li>
<li>Use a pencil and paper to write pseudocode “Broekow: Know what you are doing”</li>
<li>This will be your blue print so you know where you are going.</li>
<li>Each script and function will have a single or set of related objectives.</li>
<li>These objectives will be clearly annotated in the header.</li>
<li>Code small pieces (one or two functions) and assign the output to meaningful variable names.</li>
<li>Keep the workspace clean by discarding objects (object, functions) that are created and will not be used again.</li>
<li>Don’t be afraid to start over.</li>
</ul>
</div>
<div id="writing-your-own-functions" class="section level3">
<h3>Writing your own functions</h3>
<p>Why would we be interested in writing our own functions?</p>
<ul>
<li>Even with thousands of packages you will need ad hoc approaches in your work.</li>
<li>Many packages and associated functions are not actively maintained.</li>
<li>R is updated and the package with your function of interest may not be.</li>
<li>Some functions, in some packages, may not work with the idiosyncracies of your data.</li>
<li>Packages are of incosistent quality in terms of documentation.</li>
<li><p>Error trapping may not be sufficient.</p></li>
<li>User-made functions help keep the workspace clean.</li>
<li><p>Extraneous, unwantedobjects are not created and lurking.</p></li>
</ul>
<p>From a “clean and tidy” perspective functions help keep complex code organized.</p>
<p>Often we do the same statistical and mathematical operations over and over again.</p>
<p>I recommend having a directory of well-annotated user-created scripts with meaningful file names.</p>
<p>Anatomy of a function:</p>
<pre class="r"><code>function.name &lt;- function(x)
  {   
  # braces are used to enclose the function - start open brace
  # computational operation that only deals with function argument x
  # &quot;value to return&quot;&quot; is calculated
  #object value is created that can be of any data class.
  return(value)
  }   # braces are used to enclose the function - end closed brace   </code></pre>
<p><Br></p>
<ol style="list-style-type: decimal">
<li>Function name</li>
</ol>
<ul>
<li>A meaningful descriptor of the function.</li>
<li>Name does must not already exist in base R or contributed R packages.</li>
<li>So, “sum”, “mean”, “length” are poor function names</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>function(x)</li>
</ol>
<ul>
<li>“function” is a function that takes any number of arguments.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Someobject or set ofobjects is computed and these are returned to the user.</li>
</ol>
<ul>
<li>The function “return” is used.</li>
</ul>
<p>Lets examine the structure of a function:</p>
<ul>
<li>function is called “command.name” that does something.</li>
<li>The purpose is not important - for now we focus on teh anatomy of the command.name call</li>
</ul>
<p>command.name(measurement, argument1 = TRUE, argument2 = 3, argument3= “vals”)</p>
<ul>
<li><p>“command.name” is the name of the command - these are specific to the program and case-sensitive</p></li>
<li><p>“measurement” is a vector or column of data (numerical values or measurements) that you want to analyze, the user assigns these.</p></li>
<li><p>argument1 is some “logical” argument. The default value is “True”</p></li>
<li><p>argument2 is some “numeric” argument. The default value is “3”</p></li>
<li><p>argument3 is some “character” argument. The default value is “vals”</p></li>
</ul>
<p>Example:</p>
<ul>
<li>We may be interested in calculating the standard error of the mean.</li>
<li>Surprisingly this function is not in base R</li>
</ul>
<p>First step:</p>
<ul>
<li>Blueprint
<ul>
<li>Whatobjects are needed?</li>
<li>What parameters are created?</li>
<li>Will we need to import packages from outside base R?</li>
</ul></li>
</ul>
<p>Second step:</p>
<ul>
<li>Create a script that will calculate the standard error of the mean.</li>
<li>We will first create some normally distributed data:</li>
</ul>
<pre class="r"><code>?rnorm
nums = rnorm(n = 25, mean=100, sd=15)</code></pre>
<ul>
<li>Examine the data using a figure:</li>
</ul>
<pre class="r"><code>?hist
hist(x = nums)</code></pre>
<p>What quantities will we need to calculate the standard error of the mean?</p>
<ol style="list-style-type: decimal">
<li>The arithmetic mean of the data vector</li>
<li>The variance of the data vector</li>
<li>The number of elements in the data vector</li>
</ol>
<pre class="r"><code>?stats::var
stats::var(nums)

?length
length(nums)</code></pre>
<p>Now that we:</p>
<ol style="list-style-type: decimal">
<li>Have the components of what we need</li>
<li>Understand them</li>
<li>Have inspected the output We can proceed.</li>
</ol>
<pre class="r"><code>var.num   &lt;- var(nums)
len.num   &lt;- length(nums)

sem &lt;- sqrt(var.num/len.num)   </code></pre>
<p>Lets translate the above script into a generic function.</p>
<p>Clear workspace</p>
<pre class="r"><code>rm(list = ls())   </code></pre>
<p>Check environment tab to ensure that there are no lurkingobjects</p>
<pre class="r"><code>ls()   </code></pre>
<p>Check to make sure that our proposed function name “sem.fun” does not exist</p>
<pre class="r"><code>?sem.fun   </code></pre>
<pre class="r"><code>sem.fun = function(x)
{
  var.x &lt;- var(x)
  len.x &lt;- length(x)
sem.val &lt;- sqrt(var.x/len.x)
return(sem.val)
}</code></pre>
<p>Lets expand this basic code:</p>
<ol style="list-style-type: decimal">
<li>How can we make this code robust to missing values?</li>
</ol>
<ul>
<li>How do the length and var functions deal with NA?</li>
<li>Test them to ensure you know what is being calculated</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>What if we want a histogram returned as well as our calculated values?</li>
<li>What if we want to return a multi-element object? (hint: use list in the return function)</li>
</ol>
<ul>
<li>This list will include:
<ol style="list-style-type: decimal">
<li>The original data vector</li>
<li>Which if any of the values is/are NA</li>
<li>Which of the values are not NA</li>
<li>The mean of the data vector</li>
</ol></li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Save this function with proper and appropriate annotation.</li>
</ol>
<p>Your first step is to develop a robust script - then translate into a function.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
